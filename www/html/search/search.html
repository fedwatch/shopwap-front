<!DOCTYPE html><html><head>    <title>搜索</title>    <meta charset="utf-8">    <meta content="telephone=no" name="format-detection">    <link rel="stylesheet" href="../../css/common.css">    <link rel="stylesheet" href="../../css/style.css">    <link rel="stylesheet" href="../../css/page.css">    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">    <link rel="icon" href="../../assets/images/favicon.ico" type="image/x-icon"/>    <script type="text/javascript" src="../../assets/plugin/jquery.min.js"></script>    <script type="text/javascript" src="../../assets/plugin/iscroll.js"></script>    <script type="text/javascript" src="../../assets/plugin/iscroll-probe.js"></script>    <script type="text/javascript" src="../../assets/plugin/page.js"></script>    <!--<script type="text/javascript" src="/www/assets/plugin/sea.js"></script>-->    <!--<script type="text/javascript" src="/www/assets/plugin/seajs-text.js"></script>-->    <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">    <link rel="stylesheet" type="text/css" href="../../assets/plugin/light7/dist/css/light7.css"/>    <link rel="stylesheet" type="text/css" href="../../assets/plugin/light7/dist/css/light7-swiper.min.css"/>    <script type="text/javascript" src="../../assets/plugin/light7/dist/js/light7.min.js"></script>    <script type="text/javascript" src="../../assets/plugin/light7/dist/js/light7-swiper.min.js"></script>    <script type="text/javascript" src="../../assets/plugin/light7/dist/js/light7-swipeout.js"></script>    <script type="text/javascript" src="../../assets/plugin/handlebars-v1.3.0.js"></script>    <script type="text/javascript" src="../../assets/plugin/idangerous.swiper.min.js"></script>    <script type="text/javascript" src="../../js/config/siteUrl.js"></script>    <script type="text/javascript" src="../../js/utils/store.min.js"></script>    <!--<script type="text/javascript" src="../../js/utils/getCurrentPage.js"></script>-->    <script type="text/javascript" src="../../js/utils/parseUrl.js"></script>    <script>        $(function () {            jQuery.support.cors = true;            // searchHeader            var data = {};            var template = Handlebars.compile($("#searchHeaderTpl").html());            var html = template(data);            $("#searchHeader").html(html);            // historySearch            var historySearch = store.get('historySearch');            getHistory(historySearch);//            var historyFuns = {//                setHistorySearch: function(keyword) {//                    keyword = keyword.trim();//                    var historySearch = store.get("historySearch");////                    if (historySearch === undefined) {//                        store.set("historySearch",keyword)//                    } else {//                        var onlyItem = historySearch.split('|').filter(function (e) {//                            return e != keyword;//                        });//                        if (onlyItem.length > 0)//                            historySearch = keyword + '|' + onlyItem.join('|');//                        localStorage.historySearch = historySearch;//                    }//                },//                clearHistory:function() {//                    localStorage.removeItem('historySearch');//                }//            };            function getHistory(historySearch){                if (historySearch == '' ) {                    $(".history").hide();                } else if (historySearch !== '' || historySearch !== null) {                    var data = historySearch;                    var template = Handlebars.compile($("#historySearchTpl").html());                    var html = template(data);                    $("#historySearch").html(html);                }            }            var $searchHint = $('#searchHint');            var $searchPrompt = $('#searchPrompt');            var $searchVague = $('#searchVague');            var $historySearch = $('#historySearch');            var $clearHistoryBtn = $('#clearHistoryBtn');            var $leftFixNav = $('#leftFixNav');            var $rightSearchNav = $('#rightSearchNav');            var $cancelTextIcon = $('#cancelTextIcon');            $searchVague.css({display: "none"});            $searchHint.one("focus", function () {                $cancelTextIcon.show().css({display: "inline-block"});                $searchVague.css({display: "block"})            });            $(document).on('keyup','#searchHint', function (e) {                $("#historySearch").hide();                var $this = $(this);                var searchHint = $this.val();                if(!searchHint){//                    $.toast("你未输入搜索内容");                    return;                }//                store.set("historySearch", searchHint);                var pageOp = $("#shopListShowIndex2").page({                    url: BASE_URL + COMMON_SITE_URL.SEARCH.URL,                    param: {keyword: searchHint},                    processResult: function (result) {                        var html = "";                        if (result.products != null) {                            $.each(result.products, function (index, data) {                                html += '<div class="col-50 productCategory" >' +                                    '<a href="javascript:;"  data-id="' + data.id + '" class="external">' +                                    '<div class="productWindow" >' +                                    '<img src="' + data.image + '" alt="" >' +                                    '<h4 class="product-title" >' + data.name + '</h4>' +                                    '<span class="product-price-box"> ￥ <span style="font-size:.65rem;">' + data.price + '</span>' + '</span>' + '<span class="product-buyer-number-box">已有 <span>' + data.sales + '</span>人购买</span>' + '</div>' +                                    '</a>' + '</div>';                            });                        }                        return html;                    }                });                if (searchHint == "") {                    $cancelTextIcon.show().css({display: "inline-block"});                    $searchVague.css({display: "block"});                    $("#shopListShowIndex2").css({display: "none"})                } else {                    $("#shopListShowIndex2").css({display: "block"});                    pageOp.load({keyword: searchHint});                }            });            function searchKeywordPage(keyword){                var pageOp = $("#shopListShowIndex2").page({                    url: BASE_URL + COMMON_SITE_URL.SEARCH.URL,                    param: {keyword: keyword},                    processResult: function (result) {                        var html = "";                        if (result.products != null) {                            $.each(result.products, function (index, data) {                                html += '<div class="col-50 productCategory" >' +                                    '<a href="javascript:;"  data-id="' + data.id + '" class="external">' +                                    '<div class="productWindow" >' +                                    '<img src="' + data.image + '" alt="" >' +                                    '<h4 class="product-title" >' + data.name + '</h4>' +                                    '<span class="product-price-box"> ￥ <span style="font-size:.65rem;">' + data.price + '</span>' + '</span>' + '<span class="product-buyer-number-box">已有 <span>' + data.sales + '</span>人购买</span>' + '</div>' +                                    '</a>' + '</div>';                            });                        }                        return html;                    }                });            }            var hsArray = store.get("historySearch") || [];            $(document).on('blur',"#searchHint",function(e){                e.preventDefault();                var oldValue=$("#searchHint").val();                setTimeout(checkInput(),3000);                function checkInput(){                    var newValue=$("#searchHint").val();                    if(newValue == oldValue && oldValue.trim() !== ''){                        var historySearch = store.get('historySearch')                        if(historySearch)                        var l = historySearch.length;                        if(l < 10){                            hsArray.push(oldValue);                            store.set('historySearch',hsArray)                        }else{                            console.log(hsArray)                            hsArray.splice(hsArray-1)                            hsArray.push(oldValue);                            store.set('historySearch',hsArray)                        }                    }                }            });            $(document).on("click","#cancelTextIcon",function (e) {                e.preventDefault();                $searchHint.val("");                $cancelTextIcon.show().css({display: "inline-block"});                $searchVague.css({display: "block"});                $("#shopListShowIndex2").css({display: "none"});                var historySearch = store.get("historySearch");                getHistory(historySearch);                $("#historySearch").show();            });            $(document).on("click","#clearHistoryBtn", function () {                store.set('historySearch',null);                var historySearch = store.get("historySearch");                getHistory(historySearch);                $("#historySearch").show();            });            $(document).on("click", ".productCategory a", function () {                var $this = $(this);                var id = $this.data("id");                localStorage.setItem("currentProductID", id);                location.href = "../../html/detail/detail.html";            });            $(document).on("click", ".historyItem", function () {                $("#historySearch").hide();                $("#shopListShowIndex2").show();                var $this = $(this);                var text = $this.data("text");                if(text)                searchKeywordPage(text);                $searchHint.val(text)            })            var scroller = new IScroll('#shopListShowIndex2', {disableMouse : true,click: iScrollClick(),tap: true,probeType: 2});            function iScrollClick(){                // workaround click bug iscroll #674                if (/iPhone|iPad|iPod|Macintosh/i.test(navigator.userAgent)) return false;                if (/Chrome/i.test(navigator.userAgent)) return (/Android/i.test(navigator.userAgent));                if (/Silk/i.test(navigator.userAgent)) return false;                if (/Android/i.test(navigator.userAgent)) {                    var s=navigator.userAgent.substr(navigator.userAgent.indexOf('Android')+8,3);                    return parseFloat(s[0]+s[3]) < 44 ? false : true}            }        });    </script></head><body ><div class="mainList page">    <!--<div class="mainList">-->       <!---->    <!--</div>-->    <div class="appStatusBar"></div>    <div id="searchHeader"></div>    <!--<div class="container " style="background-color:#fff;">-->    <!--<div class="search-main">-->    <!--<div id="searchPrompt" style="display: none;"></div>-->    <div id="historySearch"></div>    <!--<div id="searchVague"></div>-->    <!--<div id="shopListSort" style="display:none;"></div>-->    <div id="shopListShowIndex2">        <div class="productContainer"></div>    </div>    <!--</div>-->    <!--</div>--></div><script type="text/x-handlebars-template" id="searchHeaderTpl">    <!--搜索模块头部-->    <header class="header-search searchSort fix_nav" style="display:flex;">        <div class="left-arrow" style="width:10%;height:2.3rem;">            <div id="leftFixNav" class="nav-left">                <a href="../../index.html" class="icon-arrow-left external"></a>            </div>        </div>        <div id="rightSearchNav" class="navbar-search right-search" style="width:90%;height:2.3rem;">            <div class="searchImgss">                <img src="../../assets/images/search2.png" class="searchIcon" style=""/>            </div>            <input id="searchHint" type="text" value="" class="pull-left form-control">            <i id="cancelTextIcon" class="cancelText" style="display:none;"></i>            <a href="javascript:history.back();" id="cancelSearchBtn" class="cancelSearch"  style="display:none;">取消</a>        </div>    </header></script><script type="text/x-handlebars-template" id="historySearchTpl">    <div class="content-block">        <div class="list-block">            <div>                <h2 style="color:#666;font-size:.65rem;">历史搜索：</h2>            </div>            {{#if this}}                <div style="padding:.5rem 0;">                    <!--历史搜索-->                    {{#each this}}                    <span class="historyItem" data-text="{{this}}">{{this}}</span>                    {{/each}}                </div>                <div class="historyLay">                    <button class="clearHistory button" id="clearHistoryBtn" style="line-height: 1.35rem;color: #fff;background: #999;border: none;">                        <i class="fa fa-trash"> </i> &nbsp; 清空历史记录                    </button>                </div>            {{else}}            <div class="historyLay">                <p  style="line-height: 1.35rem;color: #999;border: none;padding:0 .889rem;">                    主公，您什么都没有搜索耶~                </p>            </div>            {{/if}}        </div>    </div></script></body></html>